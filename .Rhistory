"OR"="oregon",
"PA"="pennsylvania",
"RI"="rhode island",
"SC"="south carolina",
"SD"="south dakota",
"TN"="tennessee",
"TX"="texas",
"UT"="utah",
"VT"="vermont",
"VA"="virginia",
"WA"="washington",
"WV"="west virginia",
"WI"="wisconsin",
"WY"="wyoming"))
`%notin%` <- Negate(`%in%`)
covid <- subset(covid, region %notin% c("RMI", "AS", "NYC", "PR", "DC",
"HI", "AK", "GU", "VI", "MP", "FSM", "PW"))
covid <- covid %>% select(-c(conf_cases, prob_cases, pnew_case,
conf_death, prob_death, pnew_death,
created_at, consent_cases, consent_deaths))
# Find total US cases from state sums
df <- data.frame(matrix(vector(), 0, 10,
dimnames=list(c(), c("date", "region", "tot_cases",
"new_cases", "tot_death", "new_death", "us_tot_cases",
"us_new_cases", "us_tot_death", "us_new_death"))))
for (i in 1:length(unique(covid$date))){
filtered_data <- covid %>%
filter(date==date[[i]]) %>%
mutate(us_tot_cases = sum(tot_cases),
us_new_cases = sum(new_case),
us_tot_death = sum(tot_death),
us_new_death = sum(new_death))
df <- rbind(df, filtered_data)
filtered_data <- data.frame(matrix(vector(), 0, 10))
}
covid <<- df
}
covid <- covid_update()
View(covid)
covid_update <- function(){
require(dplyr)
require(plyr)
covid <- read.csv("https://data.cdc.gov/api/views/9mfq-cb36/rows.csv?accessType=DOWNLOAD")
# covid <- read.csv("/Users/blakenorthrop/Desktop/QAC356/USevolve/data/US Covid (to Nov8).csv")
# covid$date <- as.Date(covid$date, format="%Y-%m-%d")
# covid <- covid %>% select(-c(X.4, X.3, X.2, X.1, X))
names(covid)[names(covid) == "submission_date"] <- "date"
covid$date <- as.Date(covid$date, format="%m/%d/%Y")
names(covid)[names(covid) == "state"] <- "region"
covid$region <- revalue(covid$region, c("AL" = "alabama",
"AZ" = "arizona",
"AR"="arkansas",
"CA"="california",
"CO"="colorado",
"CT"="connecticut",
"DE"="delaware",
"FL"="florida",
"GA"="georgia",
"ID"="idaho",
"IL"="illinois",
"IN"="indiana",
"IA"="iowa",
"KS"="kansas",
"KY"="kentucky",
"LA"="louisiana",
"ME"="maine",
"MD"="maryland",
"MA"="massachusetts",
"MI"="michigan",
"MN"="minnesota",
"MS"="mississippi",
"MO"="missouri",
"MT"="montana",
"NE"="nebraska",
"NV"="nevada",
"NH"="new hampshire",
"NJ"="new jersey",
"NM"="new mexico",
"NY"="new york",
"NC"="north carolina",
"ND"="north dakota",
"OH"="ohio",
"OK"="oklahoma",
"OR"="oregon",
"PA"="pennsylvania",
"RI"="rhode island",
"SC"="south carolina",
"SD"="south dakota",
"TN"="tennessee",
"TX"="texas",
"UT"="utah",
"VT"="vermont",
"VA"="virginia",
"WA"="washington",
"WV"="west virginia",
"WI"="wisconsin",
"WY"="wyoming"))
`%notin%` <- Negate(`%in%`)
covid <- subset(covid, region %notin% c("RMI", "AS", "NYC", "PR", "DC",
"HI", "AK", "GU", "VI", "MP", "FSM", "PW"))
covid <- covid %>% select(-c(conf_cases, prob_cases, pnew_case,
conf_death, prob_death, pnew_death,
created_at, consent_cases, consent_deaths))
# Find total US cases from state sums
df <- data.frame(matrix(vector(), 0, 10,
dimnames=list(c(), c("date", "region", "tot_cases",
"new_cases", "tot_death", "new_death", "us_tot_cases",
"us_new_cases", "us_tot_death", "us_new_death"))))
for (i in 1:length(unique(covid$date))){
filtered_data <- covid %>%
filter(date==date[[i]]) %>%
mutate(us_tot_cases = sum(tot_cases),
us_new_cases = sum(new_case),
us_tot_death = sum(tot_death),
us_new_death = sum(new_death))
df <- rbind(df, filtered_data)
filtered_data <- data.frame(matrix(vector(), 0, 10))
}
covid <- df
}
covid_update()
covid_update <- function(){
require(dplyr)
require(plyr)
covid <- read.csv("https://data.cdc.gov/api/views/9mfq-cb36/rows.csv?accessType=DOWNLOAD")
# covid <- read.csv("/Users/blakenorthrop/Desktop/QAC356/USevolve/data/US Covid (to Nov8).csv")
# covid$date <- as.Date(covid$date, format="%Y-%m-%d")
# covid <- covid %>% select(-c(X.4, X.3, X.2, X.1, X))
names(covid)[names(covid) == "submission_date"] <- "date"
covid$date <- as.Date(covid$date, format="%m/%d/%Y")
names(covid)[names(covid) == "state"] <- "region"
covid$region <- revalue(covid$region, c("AL" = "alabama",
"AZ" = "arizona",
"AR"="arkansas",
"CA"="california",
"CO"="colorado",
"CT"="connecticut",
"DE"="delaware",
"FL"="florida",
"GA"="georgia",
"ID"="idaho",
"IL"="illinois",
"IN"="indiana",
"IA"="iowa",
"KS"="kansas",
"KY"="kentucky",
"LA"="louisiana",
"ME"="maine",
"MD"="maryland",
"MA"="massachusetts",
"MI"="michigan",
"MN"="minnesota",
"MS"="mississippi",
"MO"="missouri",
"MT"="montana",
"NE"="nebraska",
"NV"="nevada",
"NH"="new hampshire",
"NJ"="new jersey",
"NM"="new mexico",
"NY"="new york",
"NC"="north carolina",
"ND"="north dakota",
"OH"="ohio",
"OK"="oklahoma",
"OR"="oregon",
"PA"="pennsylvania",
"RI"="rhode island",
"SC"="south carolina",
"SD"="south dakota",
"TN"="tennessee",
"TX"="texas",
"UT"="utah",
"VT"="vermont",
"VA"="virginia",
"WA"="washington",
"WV"="west virginia",
"WI"="wisconsin",
"WY"="wyoming"))
`%notin%` <- Negate(`%in%`)
covid <- subset(covid, region %notin% c("RMI", "AS", "NYC", "PR", "DC",
"HI", "AK", "GU", "VI", "MP", "FSM", "PW"))
covid <- covid %>% select(-c(conf_cases, prob_cases, pnew_case,
conf_death, prob_death, pnew_death,
created_at, consent_cases, consent_deaths))
# Find total US cases from state sums
df <- data.frame(matrix(vector(), 0, 10,
dimnames=list(c(), c("date", "region", "tot_cases",
"new_cases", "tot_death", "new_death", "us_tot_cases",
"us_new_cases", "us_tot_death", "us_new_death"))))
for (i in 1:length(unique(covid$date))){
filtered_data <- covid %>%
filter(date==date[[i]]) %>%
mutate(us_tot_cases = sum(tot_cases),
us_new_cases = sum(new_case),
us_tot_death = sum(tot_death),
us_new_death = sum(new_death))
df <- rbind(df, filtered_data)
filtered_data <- data.frame(matrix(vector(), 0, 10))
}
covid <- df
}
covid_update()
covid_update <- function(){
require(dplyr)
require(plyr)
covid <- read.csv("https://data.cdc.gov/api/views/9mfq-cb36/rows.csv?accessType=DOWNLOAD")
# covid <- read.csv("/Users/blakenorthrop/Desktop/QAC356/USevolve/data/US Covid (to Nov8).csv")
# covid$date <- as.Date(covid$date, format="%Y-%m-%d")
# covid <- covid %>% select(-c(X.4, X.3, X.2, X.1, X))
names(covid)[names(covid) == "submission_date"] <- "date"
covid$date <- as.Date(covid$date, format="%m/%d/%Y")
names(covid)[names(covid) == "state"] <- "region"
covid$region <- revalue(covid$region, c("AL" = "alabama",
"AZ" = "arizona",
"AR"="arkansas",
"CA"="california",
"CO"="colorado",
"CT"="connecticut",
"DE"="delaware",
"FL"="florida",
"GA"="georgia",
"ID"="idaho",
"IL"="illinois",
"IN"="indiana",
"IA"="iowa",
"KS"="kansas",
"KY"="kentucky",
"LA"="louisiana",
"ME"="maine",
"MD"="maryland",
"MA"="massachusetts",
"MI"="michigan",
"MN"="minnesota",
"MS"="mississippi",
"MO"="missouri",
"MT"="montana",
"NE"="nebraska",
"NV"="nevada",
"NH"="new hampshire",
"NJ"="new jersey",
"NM"="new mexico",
"NY"="new york",
"NC"="north carolina",
"ND"="north dakota",
"OH"="ohio",
"OK"="oklahoma",
"OR"="oregon",
"PA"="pennsylvania",
"RI"="rhode island",
"SC"="south carolina",
"SD"="south dakota",
"TN"="tennessee",
"TX"="texas",
"UT"="utah",
"VT"="vermont",
"VA"="virginia",
"WA"="washington",
"WV"="west virginia",
"WI"="wisconsin",
"WY"="wyoming"))
`%notin%` <- Negate(`%in%`)
covid <- subset(covid, region %notin% c("RMI", "AS", "NYC", "PR", "DC",
"HI", "AK", "GU", "VI", "MP", "FSM", "PW"))
covid <- covid %>% select(-c(conf_cases, prob_cases, pnew_case,
conf_death, prob_death, pnew_death,
created_at, consent_cases, consent_deaths))
# Find total US cases from state sums
df <- data.frame(matrix(vector(), 0, 10,
dimnames=list(c(), c("date", "region", "tot_cases",
"new_cases", "tot_death", "new_death", "us_tot_cases",
"us_new_cases", "us_tot_death", "us_new_death"))))
for (i in 1:length(unique(covid$date))){
filtered_data <- covid %>%
filter(date==date[[i]]) %>%
mutate(us_tot_cases = sum(tot_cases),
us_new_cases = sum(new_case),
us_tot_death = sum(tot_death),
us_new_death = sum(new_death))
df <- rbind(df, filtered_data)
filtered_data <- data.frame(matrix(vector(), 0, 10))
}
covid <<- df
}
covid_update()
#load latest covid data
covid <- USevolve:::covid_update()
#load latest covid data
USevolve:::covid_update()
#load latest covid data
covid2 <- USevolve:::covid_update()
#load latest covid data
covid <<- USevolve:::covid_update()
covid_update <- function(){
require(dplyr)
require(plyr)
covid <- read.csv("https://data.cdc.gov/api/views/9mfq-cb36/rows.csv?accessType=DOWNLOAD")
# covid <- read.csv("/Users/blakenorthrop/Desktop/QAC356/USevolve/data/US Covid (to Nov8).csv")
# covid$date <- as.Date(covid$date, format="%Y-%m-%d")
# covid <- covid %>% select(-c(X.4, X.3, X.2, X.1, X))
names(covid)[names(covid) == "submission_date"] <- "date"
covid$date <- as.Date(covid$date, format="%m/%d/%Y")
names(covid)[names(covid) == "state"] <- "region"
covid$region <- revalue(covid$region, c("AL" = "alabama",
"AZ" = "arizona",
"AR"="arkansas",
"CA"="california",
"CO"="colorado",
"CT"="connecticut",
"DE"="delaware",
"FL"="florida",
"GA"="georgia",
"ID"="idaho",
"IL"="illinois",
"IN"="indiana",
"IA"="iowa",
"KS"="kansas",
"KY"="kentucky",
"LA"="louisiana",
"ME"="maine",
"MD"="maryland",
"MA"="massachusetts",
"MI"="michigan",
"MN"="minnesota",
"MS"="mississippi",
"MO"="missouri",
"MT"="montana",
"NE"="nebraska",
"NV"="nevada",
"NH"="new hampshire",
"NJ"="new jersey",
"NM"="new mexico",
"NY"="new york",
"NC"="north carolina",
"ND"="north dakota",
"OH"="ohio",
"OK"="oklahoma",
"OR"="oregon",
"PA"="pennsylvania",
"RI"="rhode island",
"SC"="south carolina",
"SD"="south dakota",
"TN"="tennessee",
"TX"="texas",
"UT"="utah",
"VT"="vermont",
"VA"="virginia",
"WA"="washington",
"WV"="west virginia",
"WI"="wisconsin",
"WY"="wyoming"))
`%notin%` <- Negate(`%in%`)
covid <- subset(covid, region %notin% c("RMI", "AS", "NYC", "PR", "DC",
"HI", "AK", "GU", "VI", "MP", "FSM", "PW"))
covid <- covid %>% select(-c(conf_cases, prob_cases, pnew_case,
conf_death, prob_death, pnew_death,
created_at, consent_cases, consent_deaths))
# Find total US cases from state sums
df <- data.frame(matrix(vector(), 0, 10,
dimnames=list(c(), c("date", "region", "tot_cases",
"new_cases", "tot_death", "new_death", "us_tot_cases",
"us_new_cases", "us_tot_death", "us_new_death"))))
for (i in 1:length(unique(covid$date))){
filtered_data <- covid %>%
filter(date==date[[i]]) %>%
mutate(us_tot_cases = sum(tot_cases),
us_new_cases = sum(new_case),
us_tot_death = sum(tot_death),
us_new_death = sum(new_death))
df <- rbind(df, filtered_data)
filtered_data <- data.frame(matrix(vector(), 0, 10))
}
covid <- df
}
library(USevolve)
covid_growth()
covid_growth(sum=T)
#load data from data folder
county_map <- use_data("data/county_map.csv", internal=T)
require(devtools)
#load data from data folder
county_map <- use_data("data/county_map.csv", internal=T)
save(county_map, file="data/county_map.rda")
county_map <- read.csv("data/county_map.csv")
countypres <- read.csv("data/2 county president.csv")
save(county_map, file="data/county_map.rda")
save(state_map, file="data/state_map.rda")
#load data from data folder
state_map <- read.csv("data/state_map.csv")
statepres <- read.csv("data/3 state president.csv")
save(state_map, file="data/state_map.rda")
save(countypres, file="data/county_pres.rda")
save(statepres, file="data/state_pres.rda")
covid <- read.csv("/Users/blakenorthrop/Desktop/QAC356/USevolve/data/US Covid (to Nov8).csv")
save(covid, file="data/covid(Nov8).rda")
#load data from data folder
county_map <- use_data("data/county_map.rda", internal=T)
#load data from data folder
county_map <- "county_map"
#load data from data folder
county_map <- "county_map"
#load data from data folder
county_map <- "data/county_map.rda"
#load data from data folder
county_map <- data(county_map)
#load data from data folder
county_map <- data(county_map)
#load data from data folder
county_map <- data("county_map")
#load data from data folder
county_map <- data("data/county_map.rda")
?use_data
#load data from data folder
county_map <- data("data/county_map.rda")
county_map <- read.csv("data/county_map.csv")
countypres <- read.csv("data/2 county president.csv")
state_map <- read.csv("data/state_map.csv")
statepres <- read.csv("data/state_pres.csv")
statepres <- read.csv("data/3 state president.csv")
county_map <- read.csv("data/county_map.csv")
county_pres <- read.csv("data/2 county president.csv")
state_map <- read.csv("data/state_map.csv")
state_pres <- read.csv("data/3 state president.csv")
use_data(county_map, county_pres, state_map, state_pres, internal=T)
View(statepres)
county_map <- read.csv("data/county_map.csv")
county_pres <- read.csv("data/2 county president.csv")
state_map <- read.csv("data/state_map.csv")
state_pres <- read.csv("data/3 state president.csv")
use_data(county_map, county_pres, state_map, state_pres, internal=T)
use_data(county_map, county_pres, state_map, state_pres, internal=T, overwrite=T)
load("~/Desktop/QAC356/USevolve/R/sysdata.rda")
load("~/Desktop/QAC356/USevolve/R/sysdata.rda")
county_map <- data("county_map")
county_map <- data("R/county_map")
data("R/sysdata.rda")
county_map <- data("county_map")
county_map <- USevolve:::county_map
USevolve:::state_map
USevolve:::state_map
county_map <- read.csv("data/county_map.csv")
county_pres <- read.csv("data/2 county president.csv")
state_map <- read.csv("data/state_map.csv")
state_pres <- read.csv("data/3 state president.csv")
use_data(county_map, county_pres, state_map, state_pres, internal=T, overwrite=T)
county_map <- USevolve:::county_map
county_pres <- USevolve:::county_pres
state_map <- USevolve:::state_map
state_pres <- USevolve:::state_pres
library(USevolve)
county_winner()
library(pkgdown)
build_site()
library(USevolve)
build_site()
View(state_map)
View(county_map)
elect_count(level="county", states = c("connecticut", "rhode island"), log=F)
library(USevolve)
build_site()
state_winner(states=c("california", "nevada", "arizona"))
state_winner(states=c("california", "nevada", "arizona", "utah"))
# Create Function
county_winner <- function(Year=2016, states=c()){
require(maps)
require(dplyr)
require(ggplot2)
require(devtools)
# load data
county_map <- county_map
county_pres <- county_pres
county_election_years <- c(2000, 2004, 2008, 2012, 2016)
if(Year %in% county_election_years){
county_pres <- na.omit(county_pres)
county_pres$party[county_pres$party != "democrat" & county_pres$party != "republican"] <- "other"
partycolor <- c("blue2", "red1", "yellow")
names(partycolor) <- unique(county_pres$party)
###########
if(length(states)==0){
county_majority <- county_pres %>%
filter(year==Year) %>%
group_by(region) %>%
slice_max(county_percent)     ## ISSUE IN SLICE_MAX
} else{
county_map <- county_map %>%
filter(state %in% states)
county_majority <- county_pres %>%
filter(state %in% states, year==Year) %>%
group_by(region) %>%
slice_max(county_percent)
}
ggplot()+
geom_map(data=county_map, aes(map_id= region), map = county_map) +
geom_map(data=county_majority, aes(map_id= region, fill=party), map = county_map) +
expand_limits(x = county_map$long, y = county_map$lat) +
scale_fill_manual(name = "party", values = partycolor) +
coord_map("albers", lat0=30, lat1=40) +
ggtitle("County Winner Map", Year)
}
else if(Year == 2020){
stop("Data not yet available")
}
else{
stop("Must enter valid election year starting in 2000")
}
}
?requireNamespace
library(USevolve)
build_site()
library(pkgdown)
build_site()
library(USevolve)
